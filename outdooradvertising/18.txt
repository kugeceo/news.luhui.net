程序化广告生态实用手册


01..
概述

程序化广告的定义

程序化广告（Programmatic Advertising）是指利用技术手段进行广告交易和管
理。广告主可以程序化采购媒体资源，并利用算法和技术自动实现精准的目标受众定
向，只把广告投放给对的人。媒体可以程序化售卖跨媒体、跨终端（电脑、手机、平
板、互联网电视等）的媒体资源，并利用技术实现广告流量的分级，进行差异化定价
（如一线城市的价格高于二三线城市、黄金时段的价格高于其它时间段）。因此，程
序化广告可以定义为：

1.以人为本的精准广告定向；
2.媒体资源的自动化、数字化售卖与采购。
程序化广告的价值

相比靠人力进行媒介洽谈、广告管理和对广告进行无差别投放的传统广告而言，
程序化广告的最大价值是为广告主和媒体带来了营销效率和广告效果的双提升。 

1）广告主角度
效率
提升媒介采购效率：传统方式下，媒介的采购都是通过人力联系各个媒介渠道进
行价格谈判、排期、投放等，整个过程的成本高，并且不稳定、不可靠。程序化市场
下，直接加入交易市场就可以采购海量媒体网站和移动应用等资源。

-3 



提升广告投放效率：传统方式下采购的媒体资源在广告活动中无法进行统一管
理，而程序化广告通过整合的平台就可以实现针对跨媒体、跨终端等进行投放资源规
划和效果跟踪。
下采购的媒体资源在广告活动中无法进行统一管
理，而程序化广告通过整合的平台就可以实现针对跨媒体、跨终端等进行投放资源规
划和效果跟踪。

效果

提升广告投放效果：由于程序化广告已经从传统的购买媒体广告位转换到购买目
标人群，使得广告的投放效果更加可控。减少广告浪费的同时，提升转化率，扩大覆
盖面积。

缩短优化周期：实时竞价投放和实时优化的特性使得广告数据收集、分析和优化
过程变得更简单、高效。 

2）媒体角度
效率
提升媒体资源售卖效率：媒体可以将资源接入交易市场，有需求的广告主、代理
商和程序化广告平台能够直接在交易市场中购买各类资源，不需要再逐一谈判。

效果

提升流量利用率和用户体验：程序化广告关注的是每一次广告库存的销售，有效
利用优质流量和长尾流量。基于人群的属性、兴趣等标签，媒体可以对不同流量给出
不同售价，提升流量库存的收入。同时，相比传统地长期展示同一个广告，程序化广
告更贴合每个用户的所需，因此网站的用户体验也会有所提升。


-4 



02.
交易模式

不同的业务需求驱动下，程序化广告市场中产生了各种交易模式。为了更好地满
足广告主需求，我们首先需要对各交易模式有充分的了解。 

1.RTB实时竞价（Real-Time Bidding）
广告主可以在RTB交易市场自由挑选媒体资源，竞价购买目标人群。媒体可以接
入RTB交易市场，获取更多广告主，实现流量的变现。RTB交易市场有公开和私有之
分，在公开广告交易平台（Open Ad Exchange）中进行的竞价交易称为公开竞价，
在私有广告交易平台（Private Ad Exchange，行业人士一般称之为私有交易市场，
即Private Marketplace，简称PMP）中进行的竞价交易称为私有竞价。 

1）公开竞价（Open Auction, Open RTB） 
广告主可以在公开交易市场进行实时竞价购买剩余流量。这里需要说明一下，剩
余流量不代表是劣质流量，而是媒体通过传统售卖或者其它排期售卖、优先售卖后剩
余的流量。RTB竞价规则是“价高者得，次高价结算”。公开竞价模式下的流量库存
和价格都是不固定的。 

2）私有竞价（Private Auction, Private RTB） 
有些优质媒体为了保护自身媒体环境，不愿意进入公开交易市场，只邀请部分广
告主竞价购买；有些媒体为了最大化媒体收入，会把流量先经过私有交易市场，然后

-5 



- 6 - 
再进入公开交易市场。PMP私有交易市场的流量库存和价格也是不固定的，私有竞价
同样遵循RTB竞价规则。相比公开交易市场，PMP的媒体质量更优质，因而价格也会
更高。 
2.程序化直接交易（Programmatic Direct） 
相对于RTB一对多实时竞价来说，Programmatic Direct是一种non-RTB模式， 
它可以使买卖双方按照协商好的价格或流量，绕过竞价直接进行一对一交易。品牌广
告主通常会选择这种模式，并称之为程序化直接采购（Programmatic Direct 
Buying，简称PDB）。 
默认广告/打底广告（Default Ad） 
为了避免广告位出现空白情况，通常需要设定一个默认广告/打底广告用于确
保100%填充率。特别是程序化交易市场下，流量的售卖是实时发生的，无人竞价
时则展示默认广告，避免广告位的浪费。默认广告价格相对来说是最便宜的，可
以用CPM、CPC甚至CPA计费方式售卖。有些媒体也会选择用百度网盟或者阿里
妈妈网盟的广告进行打底。 
底价（Floor Price） 
RTB是实时竞价模式，按CPM出价，价高者得，次高价结算。通常广告交易
平台都会为每个广告位设定好一个底价，需求方出价必须高于这个底价才有资格
参与竞价，广告交易平台根据众多需求方的出价，选出最高价，并用比次高价多 
1分钱的价格结算。 

- 7 - 
1）首选交易（Preferred Deals） 
IAB定义这种交易模式为Unreserved Fixed Rate，即保价不保量。买卖双方协商
好固定的价格（一般高于RTB价格）进行交易。流量会优先进入首选交易，其次进入
PMP，接着进入Open RTB。不过，有些交易市场有“溢价”的概念，当RTB出价减
去首选交易价格的值大于设定的溢价时，RTB可以优先挑量。 
2）程序化保量（Programmatic Guaranteed, Programmatic Reserved, 
Programmatic Premium） 
IAB定义这种交易模式为Automated Guaranteed。首选交易和程序化保量都能
保价，只不过前者是non-guaranteed合约，后者是guaranteed合约。国内目前用的
比较多的是程序化保量采购（Programmatic Guaranteed Buying，简称PGB），行
业上所说的PDB一般也是指PGB模式。 
保量方式有两种，一种是按照双方约定好的流量100%采购，另一种是按照约定好
的返量比例进行采购，如媒体按照广告主所需比例的1.5倍进行推送流量，广告主需要
将多余的流量返还。价格跟广告主所需流量的数量和返量比例有关，不同数量不同比
例的订单价格都会有所不同。 
这里需要说明一下，私有竞价、首选交易和程序化保量都是基于订单交易的。根
据买卖双方的协商内容生成相应的订单后，双方用Deal ID作为惟一标识进行交易。
Deal订单通常会包含交易期限、价格、数量等信息。 
IAB（Interactive Advertising Bureau） 
即美国互动广告局，是开发网络广告行业标准（如RTB协议）、开展调研并发
布报告（如互联网广告收入报告）的商业组织。 

3.头部竞价（Header Bidding）
需求方可以绕过广告交易平台，通过在媒体网站或APP插入JavaScript SDK代码
直接对接媒体。媒体加载时优先向已对接的需求方发送广告请求，需求方未购买的剩
余流量才会调用广告服务器，进入广告交易平台进行售卖。 

Header Bidding的交易模式跟Private Auction有点类似，但竞价请求是First 
Look（第一优先）级别，挑选流量的优先级最高，需求方掌握流量购买的主动权，而 
Private Auction模式中，需求方能购买的流量库存（媒体通过其它方式售卖后的剩余
流量）是由媒体决定。Header Bidding虽然可以让媒体获得更大广告收益，但在数
据安全性上有一定的风险，因为需求方通过JS代码可以获取更多的用户行为数据。目
前这种方式在国内还没能推行起来。

交易模式图览


-8 



上图为程序化广告交易模式概览，数字1至5代表挑选流量的优先级从高到低，价
格通常也从高到低。这个优先级顺序和价格顺序在理论上是成立的，部分平台会有一
些小改造，但是不影响我们理解整体的交易模式情况。
图为程序化广告交易模式概览，数字1至5代表挑选流量的优先级从高到低，价
格通常也从高到低。这个优先级顺序和价格顺序在理论上是成立的，部分平台会有一
些小改造，但是不影响我们理解整体的交易模式情况。

通过下面的表格，我们可以对各交易模式的异同点有更直观的了解。大部分情况
下，效果类广告主偏好竞价模式，品牌类广告主偏好非竞价模式，有些品牌推广 
Campaign（推广计划或推广活动）涉及到排期投放，还需要保障投放量。


我们把首选交易和程序化保量的工作流程都定义为半自动，又或者半程序化。因
为媒体资源谈判和下单流程大部分还要人工进行，需求方再利用技术手段筛选这些资
源，挑选精准的人群进行广告投放。区别在于，首选交易可以只买想要的流量，而程
序化保量需要购买订单协商好的流量数量，不管是不是需求方想要的流量都得展示
（虽然有返量的交易方式，但是基本不可能做到100%流量都是需求方想要的）。

不管是公开竞价、私有竞价，还是头部竞价，基本都是CPM竞价。虽然有些需求
方平台可以按CPC与广告主结算，但是本质上需求方平台与广告交易平台（Ad 
Exchange）是以CPM结算的。首选交易和程序化保量都支持CPM或者CPC的订单购
买，另外，由于程序化保量类似传统的媒体包断模式，因此也支持按CPD方式结算。

-9 



03.
参与者

我们先从广告投放节点来看看程序化广告都有哪些参与者。有作为流量消费者的
广告主，作为流量所有者的媒体网站或APP，以及为广告主服务的代理商、需求方平
台、程序化创意平台、广告验证平台、监测分析平台，为流量所有者服务的广告交易
平台AdX或SSP，以及数据管理平台。整个流程包括广告投放方向、现金流方向、广
告服务方向以及数据提供方向。

其中，需求方平台包括DSP和Trading Desk，广告主/代理可以通过DSP投放，也
可以通过Trading Desk实现多家DSP的投放。需求方平台可以通过API接入AdX/SSP
竞价投放广告，也可以通过JS代码方式直接接入媒体网站或APP（也就是上一章节提
到的Header Bidding方式）。


-10 



广告主/代理/代理

广告主（Advertiser）是购买流量进行广告投放的最终需求方，代理商
（Agency）是广告主的业务代理人，一方面对接广告主需求，一方面寻找投放的媒
体渠道。一般分为4A公司和中小代理，4A公司主要服务大型品牌广告主。大型品牌
广告主代表有高通、SAP、IBM等；4A公司代表有奥美世纪、Accuen、安吉斯等。

需求方平台（Demand-Side Platform，简称DSP） 

DSP为需求方（即广告主或代理商）提供实时竞价投放平台，需求方可以在平台
上管理广告活动及其投放策略，包括目标受众的定向条件、预算、出价、创意等设
置，DSP通过技术和算法自动优化投放效果并提供数据报告。

根据是否有包断资源的业务，DSP分为纯DSP和混合型DSP（Hybrid DSP）。纯 
DSP代表有：舜飞|BiddingX、品友DSP等。混合型DSP除了对接AdX，还会自建Ad 
Network（广告网络或网盟，DSP和Ad Network的混合体称为DSPAN）或广告交易
平台AdX/SSP进行流量采购，代表有：360点睛（原聚效DSP）+360 MAX（原聚效 
Ad Exchange）。

另外，根据DSP对接的资源情况以及服务对象，还可以进一步分为纯Web端 
DSP、移动DSP、跨屏DSP、DSP+等类型。

纯Web端DSP：对接的流量和服务对象都是面向Web端。目前这类DSP都朝跨屏 
DSP的方向在发展。

移动DSP：专注移动端流量和移动广告主的DSP平台。

跨屏DSP：PC DSP和移动DSP的混合体，库存流量横跨多端屏幕（包括电脑、手
机、平板等）。

-11 



DSP+：DSP+广告主类型（如效果DSP、品牌DSP）、DSP+垂直行业（如金融 
DSP、电商DSP）、DSP+资源类型（如视频DSP）等。但是现在的效果DSP一般也
服务于品牌客户，所以基本没有纯效果DSP。
：DSP+广告主类型（如效果DSP、品牌DSP）、DSP+垂直行业（如金融 
DSP、电商DSP）、DSP+资源类型（如视频DSP）等。但是现在的效果DSP一般也
服务于品牌客户，所以基本没有纯效果DSP。

采购交易平台（Trading Desk，简称TD） 

Trading Desk也可以理解为需求方平台，类似DSP。为需求方提供整合多个DSP
平台的技术解决方案。需求方可以在TD统一管理多个DSP平台的投放，包括分配投放
预算、制定和调整投放策略、查看数据报告等。TD一般是为品牌广告主服务，品牌广
告主通常会同时在多家DSP供应商进行广告投放，这就涉及到整体预算、频次控制等
在多家DSP的分配以及投放活动的统一管理。 

TD平台的基础是跟各大DSP通过API对接，广告主/代理再通过TD进行广告投放以
及查看数据报告。目前DSP方提供的API分为Report类（查看DSP投放数据）和 
Operation类（设置DSP投放策略）。Report类比较普遍，DSP基本都会提供。 
Operation类的比较少，能提供的有舜飞|BiddingX等。 

TD可以分类为代理商交易桌面、独立交易桌面和品牌广告主内部交易桌面。

代理商交易桌面-ATD（Agency Trading Desk）：一般是4A代理公司服务多个
品牌广告主的交易桌面，代表有Xaxis、Accuen、AOD、昌荣等；

独立交易桌面-ITD（Independent Trading Desk）：类似ATD，但是ITD可以
服务多家广告代理公司或者直客，代表有Marketin、Chinapex、复歌等；

品牌广告主内部交易桌面-BTD（Brand Trading Desk）：一般是广告主自己搭
建或寻找技术提供商搭建的内部使用的自有交易桌面，代表有伊利Trading Desk等。

-12 



广告交易平台（Ad Exchange，简称AdX）
供应方平台（Supply-Side Platform，简称SSP）
（Ad Exchange，简称AdX）
供应方平台（Supply-Side Platform，简称SSP）

理论上是SSP（供应方平台）负责对接媒体，然后对接进AdX（广告交易平台）。
由于现在SSP的功能基本与AdX一致了，所以就把AdX和SSP放一起讲，我们可以统
称为广告交易平台。DSP通过API对接AdX或SSP，也可以通过JS代码方式直接接入媒
体。

按照媒体归属，AdX/SSP可以分为两类：

第三方AdX/SSP：通过聚合各类大中小媒体流量进行变现，包括优质流量或者长
尾流量资源。代表有：流量巨头BATG3（百度BES、阿里Tanx、腾讯Tencent AdX、 
Google DoubleClick、360 MAX）以及其它交易平台如灵集AdX（原秒针AdX）
等。

大型媒体私有AdX/SSP：大型媒体搭建的私有广告交易平台，拥有自己的媒体流
量。代表有：视频类优酷AdX、爱奇艺AdX等，门户类网易AdX、新浪AdX等。

数据管理平台（Data Management Platform，简称DMP） 

DMP能够为广告投放提供人群标签进行受众精准定向，并通过投放数据建立用户
画像，进行人群标签的管理以及再投放。代表有：百分点、达摩盘等。

按照数据归属，用户数据可以分为：

第一方数据：需求方即广告主自有用户数据，包括网站/APP监测数据、CRM数
据、电商交易数据等。

第二方数据：需求方服务提供者在广告投放过程中积累的业务数据，如DSP平台
业务中积累的受众浏览广告、点击广告等相关数据。

第三方数据：非直接合作方拥有的数据，如运营商数据等。

-13 



按照DMP平台的归属，DMP相应分为第一方DMP、第二方DMP和第三方DMP：DMP平台的归属，DMP相应分为第一方DMP、第二方DMP和第三方DMP：

第一方DMP：指大型广告主自己搭建或者寻找外部技术提供商为自己搭建的内部 
DMP，用于分析和管理用户数据，为营销环节提供决策支撑和用户数据支撑，广泛应
用于电商、游戏、旅游等行业。

第二方DMP：指需求方服务提供者（一般是指需求方平台）搭建的DMP，帮助广
告主更好的进行投放，提升效果的同时，加大投放量，间接提升广告主在需求方平台
的投放额度。

第三方DMP：指以数据交易为主要形式的DMP，为需求方提供数据交换、售卖等
服务。通常需要对接入DSP后再运用到广告投放中，如果是PC端数据，还涉及DSP与 
DMP之间需要进行cookie mapping。

程序化创意平台（Programmatic Creative Platform，简称PCP） 

PCP专注于广告创意的投放优化，通过技术自动生成海量创意，并利用算法和数
据对不同受众动态地展示广告并进行创意优化，这个过程叫做动态创意优化
（Dynamic Creative Optimization，简称DCO）。每个人看到的广告都可以是不一
样的，即使同一个人，在不同场景下看到的广告也是不一样的，可以说是千人千面。

程序化创意平台代表有：舜飞科技、Sizmek、筷子科技等。

广告验证平台（Ad Verification Platform）

广告验证平台通常也是为品牌广告主服务，为其提供广告投放过程中的品牌安全
（Brand Safety）、反作弊（Anti-Fraud）、可视度（Viewability）等保障，通过分
析投放媒体的内容合法性、正面性，为品牌广告的投放提供一个和谐的媒体环境。

广告验证平台代表有：Adbug、RTBAsia、Sizmek、IAS等。

-14 



- 15 - 
监测分析平台（Measurement & Analytics Platform） 
广告主（特别是品牌广告主）在投放过程中，通常会选择信任的第三方监测分析
平台对广告投放数据进行同步监测，用于评估广告投放平台的数据，如衡量投放的广
告展示量、点击量、受众属性等是否与三方监测报告一致。 
监测分析平台代表有：秒针系统、AdMaster等。 
媒体网站或APP 
指流量的最终拥有者，为广告主提供接触受众的平台，是现金流方向的终端。 
按载体来分，媒体包括PC Web、Mobile Web（一般叫WAP）以及APP三大类
资源；按内容来分，媒体包括综合门户、垂直门户、视频等。 
Ad Serving 
广告服务，可以理解为广告投放服务产品。没有竞价功能，主要是帮广告主
投放广告、优化并衡量广告效果，如创意轮播、频次控制、品牌安全、广告监
测、反作弊等。服务方一般是按广告投放流水的特定比例向广告主收取服务费。 
Ad Network 
简称ADN，即广告网络，一般称为网盟（如百度网盟等），可以理解为媒体
代理公司，通过采购媒体方流量卖给广告主，赚取中间差价。由于ADN手头的媒
体和广告主都有限，每家ADN的媒体流量不一定能对应上广告主需求，就导致流
量卖不出好价钱，广告主的投放效果也无法有效提升。AdX/SSP和DSP正是为了
解决这个问题而诞生的，将众多广告主、媒体甚至ADN都集结到广告交易市场
中，缓解流量市场信息不对称的问题。 

04. 
广告投放

投放流程

广告投放流程分为前期策划、执行准备、正式投放和项目总结四个阶段。 

1）前期策划
主要集中在分析投放需求，找出目标受众，并制定相应的投放策略，包括预算分
配，制定媒体策略（选择什么媒体）、人群定向策略（投放什么人群、使用什么定向
条件）、创意策略（用什么样的创意素材）。 

2）执行准备
包括技术对接并测试、资质上传并提交审核、创意制作并提交审核等。根据前期
制定的投放策略，输出数据埋点需求（埋点是指对需要统计的数据进行加代码，如注
册数统计）或其它技术对接需求等，进行相应技术操作并测试。另外，AdX/SSP通常
会要求资质文件上传，包括营业执照、法人身份证等，审核通过才具备投放资格。同
时，创意素材也提交审核（如果广告交易平台为先投后审机制，可以跳过这一步），
审核通过后才能进行投放。 

3）正式投放
需要根据前期制定的投放策略进行相应的设置，并开启投放。投放过程中需要不
断分析投放数据，根据投放效果持续优化投放策略，并定期输出数据报告。数据分析

-16 



和投放优化是一个长期的工作，广告投放人员需要根据数据表现进行投放时间、投放
预算、定向条件、创意内容等优化调整工作。 
投放优化是一个长期的工作，广告投放人员需要根据数据表现进行投放时间、投放
预算、定向条件、创意内容等优化调整工作。 

4）项目总结
投放结束后，广告投放人员需要对数据和策略进行总结，输出结案报告。结案报
告包括：投放KPI的完成情况、活动执行的关键策略分析以及达到的效果、执行过程
中的不足以及对未来的投放项目有参考意义的优化建议。


-17 



投放漏斗漏斗

广告投放过程就像是个漏斗，需要经历“推送-曝光-点击-到站-转化-保持”六个
阶段，只有抓住每一阶段用户的诉求，才能保证每个阶段的用户能够顺利进入下一个
阶段。当然，不可能每个用户都能按照这个顺序成功进入并遍历所有环节，每个阶段
都会有“流失”。我们需要分析流失原因，不断优化投放策略，并继续推送广告，使
之可以在这个漏斗中一步步转化，提升用户生命周期价值。


推送：选择目标受众，精准定向，推送广告。除了能够准确分析出目标受众外，
还需要具备精准定向目标受众的技术。

曝光：这里的曝光不是纯粹指广告成功展示在广告位，而是真正曝光到受众面
前，让受众关注到这个广告。因此，需要选择高曝光率的广告位，提升广告可视度
（Viewability）。同时，需要注重素材的展现形式（如原生广告、视频广告等）吸引
受众的关注。

点击：成功曝光到受众面前只是广告投放的基础，还要让受众对广告内容产生兴
趣并点击。因此，需要抓住受众需求点，并注重创意内容的设计，使用户理解创意、
产生兴趣并点击进入下一个阶段。

-18 



到站：广告位的创意素材和到站后看到的页面内容需要保持一致，以便受众能够
在页面看到预期甚至是高于预期的内容。
：广告位的创意素材和到站后看到的页面内容需要保持一致，以便受众能够
在页面看到预期甚至是高于预期的内容。

转化：受众对于页面内容有兴趣并产生进一步互动需求的时候，会寻找互动入
口，比如注册、下载、分享等。因此，转化入口要显眼，流程要简便、流畅。

保持：产生转化并不意味着投放的结束，提升用户生命周期价值需要使之持续转
化，如登录、复购（二次购买、持续购买），努力让受众转化成为活跃用户、忠实客
户。

投放要素

广告投放要素可以总结为“MAC”三要素：媒体资源（media）、投放人群
（audience）和创意内容（creative）。 

1）媒体资源
不同的媒体会有不同的效果，如何选择媒体和广告位是关键。程序化交易平台中
有成千上万的媒体以及各式各样的广告位，广告投放前制定媒体策略是很重要的工
作，需要根据投放KPI（即广告主用于评估效果的关键指标）选择适合的媒体。

制定媒体策略首先需要分析目标受众，根据目标受众选择匹配的媒体资源。媒体
策略可以从所要投放的广告位所在页面（page）、位置（spot）、流量
（inventory）、价格（price）和转化（conversion）五个角度来制定。

页面：包括渠道、载体（PC/WAP/APP）、媒体分类、频道、URL、页面关键词
等。

位置：广告位所在的具体位置、尺寸的大小、广告位类型、屏次（如首屏、第二
屏）等，都会影响广告的有效性。

-19 



流量：总流量的大小决定着能采购的流量大小。比如，每天需要投放3,000,000个
展示，那么起码得先确保所选媒体的总流量大于这个量级。需求方平台通常有流量预
估功能，可以为需求方的流量采购提供一定的参考价值。
：总流量的大小决定着能采购的流量大小。比如，每天需要投放3,000,000个
展示，那么起码得先确保所选媒体的总流量大于这个量级。需求方平台通常有流量预
估功能，可以为需求方的流量采购提供一定的参考价值。

价格：广告主KPI一般会对单价或量级有要求，要在有限的投放预算里面满足 
KPI，就得考虑价格。在竞价环境中，价格是不固定的，但是我们可以参考历史投放
的平均价格。

转化：除了参考流量和价格，还需要参考历史转化情况，以达到更好的媒体效果
预估。 


2）投放人群
目标受众定向分为新用户和老用户的定向投放，我们需要进行相应的拉新和留
存，即拉新客和留老客。根据二八原则，公司80%的利润来自20%的重要客户。以客
户的忠诚度来分，这20%的重要客户是指忠诚客户群体，也就是我们常说的回头客、
老顾客。因此，广告投放要抓住关键用户群，重视对老用户的重新召回。老用户可以

-20 



是访问过官网或APP的用户，也可以是注册、下载、购买用户等。同时，加大对新用
户的投放，以不断壮大老用户基数。
官网或APP的用户，也可以是注册、下载、购买用户等。同时，加大对新用
户的投放，以不断壮大老用户基数。

重定向

重定向（Retargeting），也称为再营销（Remarketing），是指对老用户进行召
回的广告投放。重定向投放的意义在于对客户进行二次营销，唤醒沉睡用户，召回流
失用户。


-21 



要提升广告投放效果，需要对重定向用户群体进行归类，按照用户的不同特性推
送相应广告。如何归类？我们可以根据重定向用户“4W1H”模型来进行：Who、 
When、Where、What、How，分别对应用户属性、时间、来源、行为、质量。根
据这个模型，我们可以从不同维度对用户进行细分，对不同群体进行个性化重定向。 
提升广告投放效果，需要对重定向用户群体进行归类，按照用户的不同特性推
送相应广告。如何归类？我们可以根据重定向用户“4W1H”模型来进行：Who、 
When、Where、What、How，分别对应用户属性、时间、来源、行为、质量。根
据这个模型，我们可以从不同维度对用户进行细分，对不同群体进行个性化重定向。 

Who-谁：即用户属性，根据属性（性别、年龄、地区、收入、兴趣爱好等）判断
这是一个什么类型的用户，比如爱好电子设备的学生群体、喜欢看汽车网站的白领、
用户等级为高级VIP等。 

When-何时：即用户行为对应的时间，根据时间可以算出用户对应的访问时长、
频率、间隔等。比如第一次访问官网、30天未登录过、每天都会访问一次等。 

Where-哪里：即对应用户的来源，是点击广告进入、通过好友分享进入、还是搜
索百度进入等，不同来源的用户代表着不同群体，比如搜索关键词进入，属于主动行
为的用户群，更贴合广告主需求，而通过点击广告进入，则可能是因为广告内容的吸
引而产生兴趣等。 

What-做了什么：即对应用户的行为，比如点击了什么类型的广告、访问了什么
内容、购买了什么商品等。 

How-如何：即用户质量如何，可以用访问深度、行为次数、订单金额等来衡量，
比如浏览了50个不同商品页面的用户、一年之内总共购买了20单的用户、30天订单
金额大于10万的用户等。

寻找新客

重定向用户固然高质，但是用户数量有限，需要对这部分人群进行扩展。扩展不
意味着盲目投放新用户，盲目通投（通投指不设任何人群属性而进行的广告投放）会
导致成本变高，效果却未必相应提升。高质的新客户从哪来？常用手段是Look 
Alike，也可以是搜索词用户。

-22 



Look Alike：又叫相似人群扩展，以重定向用户作为种子用户，根据4W1H模型
中各个维度的用户特性查找相似特性的人群。
搜索词用户：当用户有需求时，会通过搜索引擎主动查找相关信息。因此，我们
可以找供应商提供搜索词用户，对这些用户进行定向投放。 
：又叫相似人群扩展，以重定向用户作为种子用户，根据4W1H模型
中各个维度的用户特性查找相似特性的人群。
搜索词用户：当用户有需求时，会通过搜索引擎主动查找相关信息。因此，我们
可以找供应商提供搜索词用户，对这些用户进行定向投放。 

3）创意内容
选择好广告位和对应的人群，还需要有适合的创意匹配用户的喜好。即使是同一

个广告位，甚至是同一个用户，对不同创意素材的反应都是不同的。
制作创意首先要把握好创意形式（Format）和用户交互（Engagement）方式。
创意形式是指素材是以什么文件形式呈现，比如图片、文字、图文、Flash、视

频、表单或者其它。目前来看，视频创意和图文创意（如信息流）创意形式最佳，这
跟广告位特性有关，这些广告位的价格也比普通广告位高一些。
用户交互是指用户在素材上进行什么动作，如点击切换动态创意、在创意上填写
注册信息、点击广告后扩展素材、甚至是语音提交信息。


-23 



制作创意策略时还可以结合创意优化方法，包括使用动态创意对用户进行个性化
创意推荐、对创意和落地页（Landing Page）进行A/B测试以及缩短转化路径等。
创意策略时还可以结合创意优化方法，包括使用动态创意对用户进行个性化
创意推荐、对创意和落地页（Landing Page）进行A/B测试以及缩短转化路径等。

动态创意：用户的需求是动态变化的，并且每个人的需求都不一样。对不同用户
或者同一用户展示不同创意，如果纯靠人工操作，不仅速度慢，而且成本高。通过程
序化创意平台可以批量生成创意，统计每个创意对应的数据，并应用到优化决策上。 

A/B测试：在广告投放中，制作的创意和落地页都需要进行A/B测试或者多版本测
试。用数据决定最终采用哪个最佳版本。测试的前提条件是尽可能地保持测试环境以
及测试量级一致。纯粹靠人工去测试多个版本，效率比较低，而且比较难保持投放环
境的一致性，容易产生偏差。运用相关的优化工具可以大幅提升测试效率，代表有： 
ABTester测试工具。

转化路径：吸引到目标受众点击广告进行交互只是潜在转化的开始，关键还在于
转化流程是否顺畅，能否让用户方便快捷地完成转化动作。


落地页内容要与创意匹配，这是最基本的要求。如果用户点击动态创意的每个商
品，进入的都是同一个推广页面（或首页），用户只能通过搜索行为进行信息查找或
商品购买，这就直接给用户转化设置了重重障碍，最终导致用户流失。

因此，用户点击广告后要能直接进入相应的商品页面，确保整个转化流程的顺畅
进行，甚至在转化成功页面根据用户的属性为其推荐符合其需求的商品，吸引更进一
步的转化。

另外，移动端在技术层面实现转化的流程要比PC端复杂，需要用到Deeplink深度
链接技术。比如，用户在媒体APP点击广告主的APP广告后，需要判断用户是否有安

-24 



装过广告主APP。如果没有安装，需要先跳转到下载安装页面，下载安装后自动进入
广告对应的商品页面。如果用户已经安装，则直接进入对应APP商品页面。
APP。如果没有安装，需要先跳转到下载安装页面，下载安装后自动进入
广告对应的商品页面。如果用户已经安装，则直接进入对应APP商品页面。

投放策略

投放策略除了上面提到的媒体、人群、创意之外，还有一些其它相关设置，主要
分为基础设置和受众定向的设置。 

1）基础设置
设置字段设置说明
出价上限
一般按 CPM方式。部分 DSP支持 CPC或者 CPA出价（由算法代替人
工动态调控 CPM出价），广告主可以设置好能承受的价格上限，将投放
成本控制在可接受范围。
预算控制
大部分广告主都会有每一波投放的预算。提前设置好预算可以避免消耗
过度，预算分为每日预算、每周预算、每月预算或者总预算。有些投放
平台还能控制到曝光数量和点击数量级别，相应的有每日曝光数、总曝
光数或每日点击数、总点击数等。
频次控制
频次控制是指广告主设置的同一个用户在设定时间内看到特定广告的总
次数，或者在设定时间内看到某个广告素材的总次数。一方面，在预算
有限的情况下，有效的频次控制可以覆盖到更多的用户；另一方面，同
段时间内对同一用户进行大量曝光或者大量重复同一广告素材的意义不
大，有效的频次控制还能在一定程度上提升点击率和转化率。
投放时间
设置投放日期或投放时段，也可以设置为不限制。投放日期或每日的投
放时段都会对广告效果产生影响，比如周末、晚上高峰阶段。
投放速度
投放速度分为匀速和快速。有些广告主希望广告预算能够尽可能地分配
到每个小时段或者每天，就需要匀速。另外，对于一些效果类客户来
说，优质流量就可能不限预算地快速投放。

-25 



2）受众定向
设置字段字段说明
地区定向指定投放区域，包括国家、省份、城市等。
客户端定向设置受众的操作系统、浏览器、系统语言等。
移动设备
包括设备类型（如手机、平板）、设备品牌（如 Apple、华为）和设备
型号等。
运营商投放指定运营商所对应的设备，如电信、联通。
上网类型
根据用户的上网类型（ Wifi/2G/3G/4G）决定是否推送广告，比如手游
广告的投放可能因为安装包过大而排除对非 Wifi上网的用户投放。
上网场景
包括家庭、公司、学校、网吧等。投放时根据广告的受众特点选择相应
的上网场景。
天气定向
指定温度、湿度、空气指数或者温差，如空气净化设备、感冒药、羽绒
服的广告投放等。
页面内容
指定页面关键词、视频内容定向等投放，如只投放包含化妆品相关关键
词的页面，或者只投放青春偶像剧的视频广告。 
LBS定向
Location-based Service，即移动位置服务，可以根据用户所在的地理
位置推送周边服务等。 LBS定向取决于 AdX/SSP竞价请求是否携带用户
当前的经纬度信息，并非所有流量都支持 LBS定向。
人群标签定向
人群标签定向除了上面提到的重定向用户外，还可以选择第二方、第三
方的用户标签进行定向，也可以针对在搜索引擎搜索过相关关键词的用
户进行投放（比如在百度搜索“化妆品”的用户）。

-26 



考核指标

广告主在品牌和效果方面都有投放需求，按照不同重心方向分为效果广告主和品
牌广告主。效果广告主投放重心是直接效果（Performance），实现商品的价值转
化，如注册、下载、购买等，通常以短期回报来衡量，代表行业有游戏、电商等。品
牌广告主投放重心是品牌宣传（Branding），实现品牌知名度、美誉度、忠诚度，按
长期效应来衡量，代表行业有汽车、快消等传统行业。因此，品牌广告主和效果广告
主的考核指标也会有所区别。我们将广告主考核指标分为三类：基础、效果
（Performance）、品牌（Branding）。

我们先定义：广告消耗为Cost，广告展示次数为Impression，广告点击次数为 
Click。 

1）基础指标 
CPM：Cost Per Mille，或者Cost Per Thousand Impressions，每千人成本，
即广告被展示一千次对应的价格。普通banner一般在1元/CPM以内，也就是banner
广告曝光一千次的价格是1元。请注意，这里说的是一千次展示，而不是一次，即每
次广告曝光需要1/1000元，由于单位太小，所以行业约定为按千次计算。用公式表示
即CPM=（Cost/Impression）*1000。 
CPC：Cost Per Click或Cost Per Click-Through，每点击成本，即广告被点击一
次对应的价格。用公式表示即CPC＝Cost/Click。 
CTR：Click Through Rate，指广告的点击率，即广告点击次数占广告展示次数
的百分比。用公式表示即CTR＝（Click/Impression）*100%。

综合CPM和CTR可以得出CPC=CPM/（CTR*1000）。如果广告主要考核CPC，
一般会从CPM和CTR着手。

-27 



以上是比较常用的基础考核指标，另外还有其它指标如点击到达率（用户点击广
告并成功到达落地页Landing Page的比例）等。 
指标，另外还有其它指标如点击到达率（用户点击广
告并成功到达落地页Landing Page的比例）等。 

2）效果指标（Performance） 
CPA：Cost Per Action，每行动成本，一般称为每注册成本，即获取一个注册用
户对应的价格，如游戏需要用户通过广告页面注册成为玩家。用公式表示即CPA＝ 
Cost/注册数。 
CPL：Cost Per Lead，每潜在客户获取成本，即获取一个潜在客户信息对应的价
格，如汽车行业需要潜在客户通过广告页面填写表单预约试驾。用公式表示即 
CPL=Cost/Lead数量。 
CVR：Click Value Rate，指广告的点击转化率，即广告转化次数占广告点击次数
的百分比。用公式表示即CVR=（转化次数/Click）*100%，这里的转化次数可以是
注册数、Lead数量、订单数等。 
ROI：Return On Investment，投资回报率，即一定周期内，广告主通过广告投
放收回的价值占广告投入的百分比。一般来说ROI都会带上周期，如日ROI、月ROI
等。用公式表示即ROI＝回收价值/Cost。如某电商在5月份投放了100万的广告费
用，获取了价值200万的有效订单金额，则ROI为200/100=2。
这4个是比较常见的效果考核指标。不同客户有不同的考核要求，有单指标考核，
也有多指标综合考核，比如CPA要求￥30以内，月ROI要求50%以上。值得注意的
是，虽然有些优质媒体价格很贵，但是由于用户质量比较好，可以带来比较大的回
报，建议广告主可以多投放此类资源，比如投放某媒体的平均CPA是￥100元，月 
ROI是300%。

-28 



- 29 - 
3）品牌指标（Branding） 
某些品牌广告主要求进行纯广告展示，比如要求哪天在哪些渠道要投放多少广告
量等，这类广告考核集中在投放量上。目前这类广告主的比例在逐步下降，特别是程
序化广告市场下，大部分品牌广告主对投放效果会有一定的要求，只是不能像效果广
告主那样用短期效果来衡量，而是从广告投放环境和投放受众群体等角度来考核。 
独立访客数（UV数）：Unique Visitor数量，指在特定时间内访问页面的虚拟自
然人（用客户端标识）的总数。 
跳出率（Bounce Rate）：指只浏览了入口页面（一般指落地页Landing Page） 
就离开的访问量占进入该页面的总访问量的比例，用于衡量用户点击广告后进入页面
的访问质量，或者衡量该页面对用户的吸引力。 
广告可视度（Viewability）：根据IAB定义，一个展示广告只要有50%以上的像
素在屏幕上展示超过1秒钟，即为可见曝光（Viewable Impressions）。这个标准一
般适应于PC的banner广告，视频广告或者移动广告标准会有所不同，每个广告投放
平台的计算标准也会有所不同。品牌广告主通常需要考量投放广告的Viewability，限
定KPI标准进行投放质量的考核。 
频次（Frequency）：每波品牌广告通常会有频次控制的需求，提升广告展示的
有效性。比如同一波投放活动中，对每个UV的广告曝光频次不超过3次，或者是总共
需要投放3套素材，每套素材向每个UV的曝光频次不超过2次。 
有些广告位置是在第二屏甚至最后一屏，用户进入媒体如果没有滚动页面，广
告则无法进入用户的视野。以曝光计费的广告购买，只要广告曝光到广告位就会
产生费用，而不管用户是否看到广告。 

TA浓度：TA是指目标受众，即Target Audience。目标受众占总受众的比例，称
为TA浓度、TA占比或TA%。因此，TA浓度的高低，代表着TA触达率的高低。
浓度：TA是指目标受众，即Target Audience。目标受众占总受众的比例，称
为TA浓度、TA占比或TA%。因此，TA浓度的高低，代表着TA触达率的高低。

到达率（1+Reach）：目标受众在指定时期内看到广告 1次或以上的比例，又叫
净达到率或者 1+到达率。相应的还有 2+Reach、3+Reach……N+Reach，分别代表
目标受众在指定时期内看到广告 2次或以上、3次或以上……N次或以上的比例。 

IGRP：Internet Gross Rating Points，即互联网总收视点或互联网毛评点，一
般用到 OTV（Online TV，即网络电视或网络视频）广告投放中。用公式表示即： 
IGRP＝平均曝光频次*到达率*100。假设对目标受众的平均曝光频次为 3，到达率为 
70%，则 IGRP为 210。

互动率（Engagement Rate）：用于衡量广告投放中用户在广告素材或者站内
（网站或APP）的交互度和参与度。Engagement是指用户对广告产生兴趣之后，到
发生最终转化之前的动作或行为过程，如点击、分享、在线体验、站内搜索等。相应
的还可以用单次互动成本CPE（Cost Per Engagement）或CPEV（Cost Per 
Engaged Visit）来衡量。

回搜率：看过广告的用户中，在之后一段时间（如1天后、7天后、30天后等）搜
索广告主相关关键词的用户数占比，可用来衡量品牌广告对用户品牌认知的提升度。

反作弊（Anti-Fraud）：所有广告主都需要反作弊，只是效果广告主衡量短期效
果时就已经可以把大部分作弊流量过滤掉，因此对于反作弊的需求没有品牌广告主那
么大。而品牌广告主的考核指标比较容易被作弊，需要考量服务方的反作弊能力。

第三方监测gap：品牌广告主一般有信任的第三方监测公司为其广告投放过程提
供监测服务并出数据分析报告。前面提到的几个指标也是在其监测范围内，比如目标
受众曝光频次等；另外，对性别、年龄等人群属性以及地区定向的投放结果也有要
求。因此，投放效果是否达标，不仅仅在于投放平台，还有广告主考核投放平台统计
的各项指标与第三方监测指标的差异（gap值）有多大，一般会要求在10%以内。

-30 



05.
相关技术 

1.RTB竞价原理 
1）竞价逻辑
用户开启电脑，打开浏览器，访问某媒体网站（如今日头条toutiao.com），媒体
网站页面通常会有广告位。以今日头条右上角250*250的广告位为例子，假设此位置
已加入RTB交易市场。用户从进入网站，到250*250广告位置向用户呈现广告，整个
过程在毫秒级内发生。期间到底经过了哪些流程？

流程1：用户A在Web浏览器访问今日头条首页。

流程2：今日头条通知广告交易平台：首页右上角250*250广告位要向用户A展示
广告。

流程3：广告交易平台根据这个竞价请求组织一次竞价。由竞价发起服务向各需求
方发送竞价请求（Bid Request），询问是否需要竞价，并传输用户A的User ID（广
告交易平台的用户cookie或者移动设备ID等）、用户IP和广告位信息（页面URL、广
告位置等）。

流程4：需求方竞价监听服务接收到广告交易平台发来的竞价请求后，将竞价请求
信息传输给竞价引擎。

流程5：竞价引擎根据广告交易平台User ID向用户数据中心查询用户相关信息。
如果是PC端，竞价引擎需要查询cookie mapping数据库，得出用户在需求方系统的 
cookie ID（如果需求方对应的cookie不存在，则向广告交易平台请求cookie 
mapping）。

-31 



- 32 - 
流程6：用户数据中心向竞价引擎返回用户A的信息，如性别、年龄、兴趣爱好
等。返回的具体用户信息需要参照用户数据中心的信息维度而定。 
流程7：竞价引擎将用户数据和投放需求进行匹配，决定是否参与出价以及CPM出
价。 
流程8：竞价监听服务向广告交易平台发送出价响应（Bid Response），并发送
CPM价格和广告代码。如果不参与竞价，则不响应。 
流程9：广告交易平台接收到所有需求方的出价响应后由竞价决策服务进行竞拍。
价高者得，次高价结算，即出价最高的需求方赢得本次展示，并以第二高的投标价格
（通常比第二高多1分钱）跟广告交易平台结算。同时，竞价决策服务需要为供应方
（今日头条）返回赢得本次竞价的需求方的竞价信息（CPM价格和广告代码）。 
广告投放管理平台 
广告主在广告投放管理平台设置投放时间、预算、地区定向、用户属性等投放
策略。竞价引擎需要将用户信息跟广告主设置的投放策略进行匹配，由此判断是
否参与竞价。 
算法模型 
算法模型是实时竞价过程中最主要的决策部分，主要围绕广告主投放需求、媒
体质量、人群属性、创意内容、用户场景、市场环境（实时竞价市场中的竞争激
烈程度）这六大模块细分不同维度，并通过不断升维和降维进行自动调优，以达
到价格和效果的最优值。比如算法模型会根据历史投放数据、用户数据等信息判
断/预估哪些用户是高质量用户，是否值得竞价以及应该出价多少。 

- 33 - 
流程10：Web浏览器向需求方请求广告物料的展示。 
流程11：需求方物料管理服务返回对应的广告物料。需要说明的是，广告物料必
须先经过CDN服务再呈现在广告位。另外，需求方平台还会收到广告交易平台发送的
竞价消息（Win Notice），表示该次展示已经竞价成功。 
流程12：用户A看到广告，当前竞价流程结束。 
CDN加速服务 
CDN全称Content Delivery Network，即内容分发网络，可以使广告内容的
传输和加载更快更稳定。对于图片、Flash、特别是视频FLV等类型的广告物料， 
必须经过CDN加速，媒体环境才能更快地加载广告物料内容（加载时间控制在1s 
内），让用户能够快速看到广告内容。 
竞价过滤 
在广告交易平台发过来的竞价请求中，需求方平台会根据广告主设置的投放条
件和KPI要求以及流量质量等进行过滤，过滤掉的流量将不应答出价。另外，有反
作弊能力的需求方平台还会对作弊流量进行过滤，保障投放效果，减少投放浪
费。 
需求方平台内部竞争机制 
需求方平台会在满足参与竞价条件的众多广告主中，根据内部平台每个广告主
的出价高低、转化预估等综合标准来判断由谁胜出内部竞争，再用胜出者的出价
返回给广告交易平台。 

-34 



2）竞价结算规则 
DSP会先从内部挑选出最高的价格与外部DSP竞争，AdX/SSP综合各家DSP提交
的价格进行拍卖，把广告展示给出价最高的DSP。如下图，DSP A里面的最高价是广
告主A.1的￥3，次高价是广告主A.2的￥2.5，但是对于AdX/SSP来说，收到的价格分
别是DSP A的￥3、DSP B的￥2、DSP C的￥1.9，因此此次广告展示由DSP A竞得，
展示广告主A.1的广告，并以￥2.01（比次高价多1分）的价格与AdX/SSP结算，而不
是以DSP A的次高价￥2.5结算。


-35 



3）竞价相关指标
竞价指标指标说明计算公式
竞价请求量
总流量，即 AdX/SSP可以发送给 DSP的
竞价请求总量。
预过滤后请求量
通过设置预过滤（ pre-targeting）后的竞
价请求量，如过滤三线城市流量。
实际发送请求量QPS过滤后的请求量。
实际发送率
实际发送的竞价请求量占竞价请求总量的
比例。
实际发送请求量 /竞价请求总量
出价次数参与竞价的次数。有效竞价次数 +无效竞价次数
出价率出价次数占实际发送请求量的比例。出价次数 /实际发送请求量
放弃竞价次数
由于流量属性不符合广告主的广告投放策
略设置而放弃竞价的次数。
实际发送请求量-出价次数
放弃竞价率放弃竞价次数占实际发送请求量的比例。放弃竞价次数 /实际发送请求量
有效竞价次数符合投放要求并成功响应的竞价次数。成功竞得次数 +竞价失败次数
无效竞价次数
行业限制、创意不符、素材未提交审核或
审核未通过、响应超时、解析错误等原因
造成的竞价次数。
出价次数 -有效竞价次数
响应超时次数
网络错误或超时（响应时长限制是 
100ms）的次数。
响应超时率响应超时次数占实际发送请求量的比例。响应超时次数 /实际发送请求量
解析错误次数
竞价响应返回的数据格式错误等原因造成
的次数。
解析错误率解析错误次数占实际发送请求量的比例。解析错误次数 /实际发送请求量
成功竞得次数成功赢得广告展示机会的次数。
成功竞得率成功竞得次数占出价次数的比例。成功竞得次数/出价次数
竞价失败次数
出价低于对手或者出价跟对手相同但是没
有被 AdX/SSP选中的次数。
有效竞价次数 -成功竞得次数
竞价失败率竞价失败次数占出价次数的比例。竞价失败次数 /出价次数
使用率成功竞得次数占实际发送请求量的比例。成功竞得次数 /实际发送请求量

-36 



- 37 - 
2.Cookie映射流程 
程序化广告生态是以人为本的生态，要实现精准定向人群，首先要解决识别人群
中每个个体的问题。在PC上，通常用cookie作为“人”的唯一标识，为每个“人”打
标识的技术业内叫“种cookie”。 
在程序化广告的“参与者”图中可以看到，人群流向轨迹是网站->AdX或
SSP->DSP->广告主官网。在这些环节中，每个参与者都需要对PC上的用户打
cookie进行标识，而不同参与者命名cookie的方式都不同，即使同一个用户，DSP可
能命名为123，AdX可能命名为ABC。 
我们应该怎样将各参与者的cookie串联起来，识别出它是同一个用户呢？这时就
需要用到cookie映射技术（cookie mapping或cookie matching）。通过映射，将
DSP家的用户123和AdX家的用户ABC对应起来。 
QPS（Query Per Second） 
即每秒查询率，是对一个特定的查询服务器在规定时间内所处理流量多少的衡
量标准。DSP可以在AdX/SSP管理后台设置能接受的QPS值。 
移动设备ID映射 
移动端用设备号ID（如IMEI号、Android-ID或IDFA）识别用户，这些ID都是
固定的，并且能够在不同APP中共享。一般情况下，移动设备ID不需要mapping 
映射，但由于部分AdX发给DSP的ID会采用加密方式（如md5加密），因此， 
DSP方需要将竞价请求中的加密ID与原始ID进行映射，才能更好地进行移动端的
人群标签定向。 

假设用户A正在使用浏览器访问网站。在此用户A浏览器中，AdX的cookie ID为 
AdX-UID，并且DSP未在此种过cookie。
A正在使用浏览器访问网站。在此用户A浏览器中，AdX的cookie ID为 
AdX-UID，并且DSP未在此种过cookie。


流程1：AdX发送竞价请求给DSP，携带AdX-UID。

流程2：DSP根据AdX-UID查找映射表，如果不存在此映射关系，则需要向AdX
发起cookie mapping请求，并在竞价成功后返回广告投放代码Ad Tag，此Ad Tag
将携带1*1的透明像素图片<img src="AdX域名的cookie mapping URL" />。注
意，这里的cookie mapping是由DSP发起的，不过，部分AdX也支持主动发起 
cookie mapping。

流程3：AdX发送DSP的Ad Tag到浏览器。

流程4：浏览器触发该Ad Tag中的1*1透明像素图片，触发AdX的cookie 
mapping服务。

流程5：AdX的cookie mapping服务查找DSP设置的cookie mapping URL（DSP对接AdX时，设置对应的cookie mapping URL），并进行302跳转，重定向
到DSP并携带AdX-UID。AdX传送给DSP的AdX-UID通常是原始的AdX的cookie 
ID，部分AdX会对此ID加密。

-38 



- 39 - 
流程6：DSP发送1*1的透明像素图片（携带cookie ID，假设为DSP-UID）到浏
览器，种上DSP cookie，并保存此DSP-UID和AdX-UID的映射关系。需要说明的
是，谁发起cookie映射以及谁负责保存映射关系并不是硬性规定的，可以经由双方协
商确认。 
强制cookie映射 
如果DSP在某些AdX的投放量很小，按照上述流程可知，cookie mapping的
机会也比较少，导致DSP在这些AdX上可识别的人群也不多。如果需要投放人群
标签的话，可能会导致投不出量或者很少量。 
DSP可以通过强制cookie映射扩大可识别的人群数量。强制cookie映射是指
DSP在某家AdX赢得展示后，除了可以与该AdX进行cookie映射外，还可以在广
告曝光时发起其它AdX的cookie映射请求，比如曝光时发送AdX A的映射URL 
后，由AdX A进行302重定向返回DSP，DSP继续302重定向到AdX B的映射
URL……可以持续进行多个AdX的映射，但是并不代表可以无限映射，因为浏览器
会限制跳转次数，而且不同浏览器限制的次数不同。 
DSP与DMP映射 
如果DSP需要对接第三方DMP或者其它第三方服务的数据，同样需要cookie 
映射。跟强制cookie mapping原理一样，DSP在广告曝光时发起DMP或者其它
第三方服务的cookie映射请求。 
ping。

衡量指标 

衡量需求方平台购买精准人群的实力，除了是否对接了大量流量资源之外，通常
还会考量需求方平台与广告交易平台或其它数据供应方之间的cookie mapping比
例，以及需求方平台与数据供应方的“人群匹配率”。 

cookie mapping比例越高，代表需求方平台能识别的人群越大。能识别的人群库
足够大，才能帮需求方采购更多的精准人群。

另外，还需要考量第三方数据在需求方平台的“人群匹配率”。匹配率越高，人
群标签能够在流量池中被命中的机会就越大，需求方平台才有可能大面积地覆盖所需
人群。 

3.数据统计原理
不管是广告投放中还是投放后，我们都需要对广告效果进行验证观察，才能更好
的评估、制定和调整投放策略。同时还需要根据每个用户的行为数据进行广告、网站
或APP优化，从而提升用户转化和留存。收集广告投放数据和用户行为数据，需要通
过部署统计代码或技术对接来实现。 

1）网站统计逻辑
流程1：浏览器向网站Web Server发起请求URL。

流程2：网站Web Server解析请求URL并生成Html文档响应返回给浏览器。

流程3：浏览器解析Html文件，加载外部脚本、样式表和图片等，触发JS统计代
码。

流程4：解析并执行JS脚本，请求数据收集脚本。通过浏览器内置JS收集域名、 
URL、页面标题、分辨率、客户端语言、referrer、cookie（如果在此用户浏览器种

-40 



过cookie，则能获取到对应cookie信息；如无，则通过流程6.1种cookie）等信息，cookie，则能获取到对应cookie信息；如无，则通过流程6.1种cookie）等信息，

以及自定义事件（如注册等）数据。
流程5：传输收集的信息给后端脚本。
流程6：流程6.1后端脚本生成透明1*1像素图片，在浏览器中种入cookie标识访

客。流程6.2后端脚本解析并发送流程5得到的信息，并从网站Web Server获取IP、访

问时间等信息，写入日志Log队列。
流程7：日志信息发送至实时统计服务。实时统计后数据入库至实时数据库。
流程8：离线统计服务从实时数据库调用数据进行离线分析，并入库至离线数据

库。
流程9：查询数据库，并进行可视化数据报表呈现。


-41 



- 42 - 
2）APP统计逻辑 
流程1：APP应用客户端向App应用服务端发起请求。 
流程2：APP应用服务端响应请求并返回应用信息。 
流程3：APP应用客户端调用统计SDK并初始化，同时通过API接口（OC/Java） 
写入版本、渠道等信息，并进行数据埋点。 
流程4：收集应用运行信息，包括访问者唯一标识、访问时间、应用版本号、运营
商、联网方式、操作系统等。移动端访问者唯一标识通常是IMEI号、Android-ID或
IDFA等。 
流程5：在APP启动/关闭时或收集的信息数量达到某一上限时，传送信息给后
端。 
流程6：后端脚本解析并发送流程5得到的数据包，写入日志Log队列。 
流程7：日志信息发送至实时统计服务。实时统计后数据入库至实时数据库。 
流程8：离线统计服务从实时数据库调用数据进行离线分析，并入库至离线数据
库。 
流程9：查询数据库，并进行可视化数据报表呈现。 
浏览器指纹 
用户使用浏览器浏览网站时，该用户浏览器相关的数据和操作称为指纹，如
userAgent（包含浏览器版本号等信息）、http_accept（http协议头中的一个字
段）、plugins（浏览器安装的插件信息）、timezone（时区信息）、fonts（系
统安装字体）等。这些指纹信息都与用户的个人习惯、使用环境有关，综合用户
其它信息（如IP地址等）时，可以有效辨别用户特征，因此称为浏览器指纹。进行
反作弊工作时，经常需要用到这些指纹信息。 

3）S2S对接 
iOS类广告主由于涉及应用上架审核相关原因，一般都不愿意加广告商的统计 
SDK，但是广告商在广告投放时需要转化数据（如安装激活）来评估效果并调整策
略。目前常用方式是广告商（这里以DSP为例）通过与广告主S2S（Server To 
Server，服务器对服务器）对接来接收转化数据。

流程1：用户A在手机上打开媒体APP，看到广告后产生兴趣，并点击广告。

流程2：媒体APP请求DSP的跳转URL，携带用户A的设备信息（如设备号 
IDFA）。

流程3：DSP进行302跳转至广告主的中转URL，携带IDFA和曝光/点击ID等信
息。

流程4：广告主服务器保存IDFA和曝光/点击ID信息，并302跳转至APP Store。

-43 



- 44 - 
流程5：用户产生下载并安装广告主APP。第1次打开广告主APP时，APP触发广
告主服务器会带上设备信息（如果用户不下载，则这次点击没有对应的转化数据）。 
流程6：广告主服务器匹配流程4中保存的信息，并查找最近一次点击，将激活匹
配到该点击（这里我们假设最后一次点击是该DSP产生的），传送激活信息给DSP。 
流程7：DSP收到激活信息，根据曝光/点击ID将此次激活和对应的设备ID计入对
应的推广活动。 
有些广告主使用的是第三方移动监测服务，这种情况下，流程中的广告主服务
器部分也可以由该监测服务提供商代替，如TalkingData、热云等。 
另外，如果有些媒体APP无法提供IDFA，可以用设备的“IP+userAgent”信
息代替，前提是广告主愿意接受这种方式，只是精准度不如IDFA，因为用户IP会
变化。 

4.程序化创意
程序化创意，就是实现从创意制作到投放优化整个过程的程序化。针对不同受众
的不同消费需求，或者同一受众在不同时期不同场景的不同消费需求，程序化自动生
成个性精准创意，最大化刺激消费需求，提升创意制作效率和广告投放效果。 

1）DCO原理
动态创意优化（Dynamic Creative Optimization，简称DCO）：根据用户的标
签属性匹配相应的创意，并根据他们的行为实时调整策略，自动选择最优方案。


-45 



流程1：PCP通过商品对接服务对接客户的商品信息，包括商品的名称、价格、页
面、库存等。需要注意的是，商品库存和价格信息对实时性有要求（试想像一下，用
户点击某广告进入想购买，结果收到库存不足或者价格变化的提醒），其它数据对实
时性要求没那么高。商品库对接方式：JS代码、Feed接口、FTP方式、Excel/CSV导
入等。
1：PCP通过商品对接服务对接客户的商品信息，包括商品的名称、价格、页
面、库存等。需要注意的是，商品库存和价格信息对实时性有要求（试想像一下，用
户点击某广告进入想购买，结果收到库存不足或者价格变化的提醒），其它数据对实
时性要求没那么高。商品库对接方式：JS代码、Feed接口、FTP方式、Excel/CSV导
入等。

流程2：商品信息入库。

流程3：创意管理平台调用商品库的商品信息和用户数据中心的用户信息设置动态
创意规则，设置好需要推荐的商品、展示方式、创意样式等（如库存量低于某个值
时，该商品不推荐；一次推荐5个商品，按销量降序排列等）。PCP将设置好的动态
创意规则生成创意代码Ad Tag，发送到DSP。

流程4：DSP竞价成功后，发送Ad Tag到浏览器。

流程5：浏览器向PCP创意渲染服务发起创意请求，携带当前用户的唯一标识User 
ID。

流程6：创意渲染服务向推荐引擎请求该User ID对应展示的创意内容，并携带Ad 
Tag对应的商品规则。

流程7：推荐引擎向用户数据中心查询该User ID的用户信息，如兴趣爱好、行为
数据等。

流程8：用户数据中心返回用户信息。

流程9：推荐引擎根据用户信息以及商品规则，得出要推荐展示的商品，并从商品
库查询调用商品信息，返回到创意渲染服务。

流程10：创意渲染服务根据推荐引擎返回的商品信息和Ad Tag对应的创意样式
等，生成个性化创意，并展示到浏览器中。

-46 



2）创意制作流程
为了实现程序化自动批量生成创意，我们需要在创意管理平台制作和管理创意。
首先定好创意基本框架（称为创意模板），框架里面的内容可以分成5部分，也可以
称为5个元素： 

Key Vision（主视觉）：显示创意的主要内容，通常是指商品图片。 
Logo（品牌标识）：用于显示广告主的Logo。 
Information（文案说明）：主视觉的补充说明信息，通常是商品名称、价格、

折扣信息等。 
Call to Action（行为召唤）：与用户进行互动，一般是转化通道，如下载、注
册、购买按钮等。 
Background（背景图）：背景图，一般用来美化衬托创意。


以上列举的是通用模板，当然，这5个元素不是必须同时存在，也不限于这5个元
素，但制作思路基本一致。

-47 



动态创意制作流程：创意制作流程：

流程1：上传各元素内容，形成物料库。包括Logo、商品信息（包括图片、名
称、价格、折扣等信息）、按钮等。商品信息一般对接广告主商品库批量导入。

流程2：制作模板，定义好尺寸比例、各元素的位置及内容来源（比如主视觉引用
商品库的商品图片，文案说明引用商品库对应商品的名称和价格）等。

流程3：设置创意规则，比如对女性用户展示模板A、商品内容为该用户加入到购
物车的信息、每个动态创意自动轮播展示5个商品、商品展现顺序按热销度降序排列
等。

流程4：将模板和规则应用到广告投放，程序化自动生成创意展现给用户。 

5.用户数据中心
在RTB竞价逻辑图和DCO原理图中均出现了用户数据中心，具体是如何实现数据
输入、标签生产与管理、数据输出呢？我们通过下图可以对其工作流程有大概的了
解。


-48 



流程1：将第一方、第二方、第三方数据输入到用户数据中心，包括：通过收数
接口传输广告主通过加代码埋点时统计到的网站或APP的数据、通过收数接口传输广
告投放时的业务数据（如曝光、点击数等）、通过对接接口传输外部数据（包括广告
主CRM数据、电商交易数据、第三方DMP数据等）。
1：将第一方、第二方、第三方数据输入到用户数据中心，包括：通过收数
接口传输广告主通过加代码埋点时统计到的网站或APP的数据、通过收数接口传输广
告投放时的业务数据（如曝光、点击数等）、通过对接接口传输外部数据（包括广告
主CRM数据、电商交易数据、第三方DMP数据等）。

流程2：传输数据信息并写入日志Log，包括2.1的收数接口和2.2的对接接口传输
数据到日志整理存储。需要注意的是，由于数据输入的来源较多，用户标识不一致，
特别是PC环境下的cookie，因此需要用户ID映射表将所有来源的数据用唯一ID打
通。

流程3：日志管理存储将汇总后的数据信息（包括结构化数据、半结构化数据和非
结构化数据）发给数据处理服务。

流程4：数据处理服务对日志信息进行标准化处理，发送到分析引擎。

流程5：分析引擎对数据进行清洗，过滤作弊数据和其它异常数据，将有效数据发
送到算法中心。

流程6：算法中心结合标签规则模型对数据进行机器学习和数据挖掘，将数据标签
化处理后返回给标签管理平台。

流程7：标签管理平台通过输出接口同步数据到各数据应用平台，如DSP、PCP、 
AdX/SSP或其它平台。 

6.反作弊 
1）作弊环节
从整个广告投放流程来看，作弊节点不外乎存在于曝光、点击和转化（包括但不
限于注册、激活、互动、购买等）三个环节：

曝光环节：针对曝光环节的作弊最简单粗暴，也最高效，常见于用CPM结算的媒
体。

-49 



点击环节：常见于用CPC结算的媒体。随着广告主越来越看重CTR，一些非CPC
结算的媒体，也会为了提升CTR在点击上做手脚。
：常见于用CPC结算的媒体。随着广告主越来越看重CTR，一些非CPC
结算的媒体，也会为了提升CTR在点击上做手脚。

转化环节：广告主为了降低风险，直接跟媒体谈判CPA甚至CPS的结算方式。但
是上有政策下有对策，来自流量端的作弊手段的进化速度已经超过了广告主的应变速
度。 

2）作弊方式
大多数情况下，需求方都把焦点放在了非人类流量上，然而作弊远远不止那些机
器人流量。下面简单列举几种常见的作弊方式：

假用户：一般是利用机器人，不断地变换IP、cookie甚至设备ID等来伪装成不同
的“用户”去刷广告页面或点击广告。

真用户假流量：这类作弊是机器人作弊的进阶版。它利用了真实的用户设备，使
得作弊流量的用户属性特征更接近真实流量。常见手段有：广告容器设置为1x1像
素、利用插件植入不可见的广告位置、肉鸡刷广告、雇佣“枪手”刷广告等。

真用户真流量：这类作弊相较于前两种作弊方式而言逼格更高。表现一就是“挂
羊头卖狗肉”，用劣质流量滥竽充数卖高价。表现二是通过http或者DNS进行流量劫
持，不完全算是作弊流量，叫它“非法流量”可能更准确。 

3）反作弊方法
反作弊工作需要事前预防、事后追溯、人工排查、智能算法等方式多管齐下。下
面从“用户标识、用户行为、广告来源”三个角度讲解反作弊的基础理论和方法，基
于这些理论和方法，我们才能更好地去完善反作弊算法和人工排查。

-50 



用户标识

一般是根据IP、cookie（或设备ID）作为分辨用户的依据，统计某些用户是否存
在高频次或高频率曝光或点击。有些媒体会通过机器人来变换IP，干扰视线，这种情
况下就必须综合考虑浏览器指纹等信息来识别作弊流量。比如：当IP或者cookie都
不一样，但是这群IP或者cookie的浏览器型号、分辨率、用户窗口大小、操作系统版
本号、设备品牌都相同时，就需要引起特别注意。

用户行为 

.广告浏览/点击
对用户的广告浏览频次/频率和点击的频次/频率进行分析。常见的作弊行为模式
包括：

-51 



1.同一用户、同一时间在多个广告位产生了浏览或点击行为，或短时间内在同一
广告位产生多次曝光或点击； 
2.同一用户的广告浏览或点击时间间隔过于规律； 
3.曝光数和点击数在某个时间点暴涨； 
4.用户未浏览广告就直接产生了点击行为，通常表现为出现大量无曝光的点击； 
5.用户浏览广告的面积和时长数据异常，可用广告可见度（Viewability）衡量和
分析； 
6.用户点击广告的位置过于规律或过于集中，一般用广告位热图来观察分析； 
7.用户行为的各环节（浏览广告->点击广告->到站->转化）遵循严谨的时间先
后顺序，如果点击广告的时间早于浏览广告的时间，或浏览和点击行为之间的时间间
隔异常，一般可以判断为作弊。 
.到站情况
综合考量用户留存、停留时间，访问深度等指标，用于分析转化用户的质量。同
时，还得关注用户的站内交互情况（点击、滚动、输入等操作）。和广告点击作弊一
样，为了制造用户活跃的假象，作弊的媒体供应方可能会利用机器产生大量页面点
击，同样地，我们可以利用点击的区域、次数、频率、页面窗口大小等指标去伪存
真。

广告来源

对到站流量进行来源页面（一般叫refer）的侦查。将refer数据与投放媒体进行匹
配，如果出现以下情况，则可以判定为作弊流量： 

1.出现大量无refer的广告流量：一般是通过非法手段直接刷广告点击代码，而不
是通过媒体页面上的广告点击跳转。
-52 



2.refer与所投放的媒体不对应，例如要求投向A网站，refer却出现大量B网站。 
7.品牌安全
由于品牌广告宣传的是品牌的美誉度，因此对投放环境的要求非常高。比如品牌
广告不允许出现在色情网站、敏感时事新闻等媒体上，否则用户可能会对此品牌产生
负面印象，严重时还会影响品牌形象。

品牌广告的投放需要品牌安全（Brand Safety）的保障，这个保障通常会有专门
的品牌安全供应商（也就是我们前面提到的广告验证平台）提供服务，广告主通过广
告验证平台设置敏感或非法的关键词/页面的黑名单，投放时过滤此黑名单的流量。 

DSP平台需要提前对接好这些广告验证平台，用于支持品牌广告的投放，此对接
分为Pre-bid和Post-bid，可以理解为竞价前和竞价后的品牌安全。 

Pre-bid：DSP平台在出价前会先询问广告验证平台，根据此流量是否符合广告主
设置的条件来决定是否出价，将效果差和内容敏感的流量排除在外，而不产生流量费
用。 

Post-bid：DSP平台在竞价成功后询问广告验证平台，广告验证平台根据广告主
设置的条件返回结果。如果流量符合条件，则展示广告主广告；反之，则用空白或者
其它图片代替。由于是在竞价成功后才进行流量的判断，因此，不管流量是否符合条
件，广告主都需要为此流量付费。

-53 



附录 -程序化广告生态大事记录 -程序化广告生态大事记


-54 



本文主要讲解程序化广告生态中涉及的相关产品、业务、运营及技术知识点，旨
在帮助产品人员更好地了解业务与产品相关技术，帮助商务/运营/销售人员更好地了
解产品和技术逻辑，帮助技术人员更好地了解产品形态与业务，帮助其它对程序化广
告有兴趣的人员更好地了解整个生态！本文将持续更新。如本文观点有误，欢迎指
正；如有其它意见或建议，欢迎积极交流。舜飞程序化学院版权所有，转载请注明出
处。


